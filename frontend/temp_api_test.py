import sys,json; sys.path.insert(0,'c:/net/backend'); from fastapi.testclient import TestClient; from src.main import app; from src.core.config import settings; from src.repository.fs_repository import reset_repository; settings.PERSISTENCE_BACKEND='sqlite'; settings.ENABLE_DUAL_WRITE=False; settings.ENABLE_FS_FALLBACK=False; reset_repository(); client=TestClient(app); payload={'strategy_code':'SL+','target_offsets':[{'start':0,'end':3}],'origin':'human','status':'created','comment':'primeiro'}; r=client.post('/api/v1/annotations?session_id=dbgsl', json=payload); print('create', r.status_code, r.text); print('export jsonl:\n', client.post('/api/v1/annotations/export?session_id=dbgsl&format=jsonl').text)
